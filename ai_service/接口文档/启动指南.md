 ## 初始化
cd ai_service
python -m venv venv
.\venv\Scripts\activate
pip install -r requirements.txt
uvicorn main:app --host 0.0.0.0 --port 8000 --reload   

在运行网站下的/docs可以看到Swapper网站查看接口文档
如：http://127.0.0.1:8000/docs


## 运行
mvn spring-boot:run

cd .\frontend\
npm run dev

cd ai_service
./venv/Scripts/activate
uvicorn main:app --host 0.0.0.0 --port 8000 --reload

## 识别视频指南

识别视频需要确保本地安装ffmpeg

安装 ffmpeg（系统级命令行工具）Windows 下安装方法：

直接点击 https://www.gyan.dev/ffmpeg/builds/ffmpeg-release-essentials.zip 下载

或者访问官网下载页：https://ffmpeg.org/download.html
→ 选择 Windows builds by BtbN（或 https://www.gyan.dev/ffmpeg/builds/）
下载 ffmpeg-release-essentials.zip，解压得到 ffmpeg/bin/ffmpeg.exe
（注意Win系统下载zip文件，tar.gz是给Linux系统用的）

添加环境变量（重要）：

将 ffmpeg/bin 所在路径复制下来，比如：D:\Toolkits\ffmpeg\bin

打开系统设置 → 环境变量 → 选择“Path” → 添加这条路径

打开新的终端窗口，输入 ffmpeg -version 检查是否安装成功

## 识别图片/图片型PDF指南

识别图片需要确保本地安装了Tesseract-OCR工具对图片进行识别，
如果没有安装控制台/日志可能报错：
~~~txt
2025-06-30 16:16:36,566 - api - ERROR - Error processing file test.png: tesseract is not installed or it's not in your PATH. See README file for more information.
INFO:     127.0.0.1:61932 - "POST /embedding/upload HTTP/1.1" 500 Internal Server Error
~~~
安装教程如下：

1. 第一步：安装 Tesseract-OCR
你是 Windows 系统，请按照以下步骤安装：

访问官方下载地址：
👉 https://github.com/tesseract-ocr/tesseract

也可以直接下载 Windows 安装包（推荐这个）：
👉 https://digi.bib.uni-mannheim.de/tesseract/

点击下载：
tesseract-ocr-w64-setup-5.x.x.exe

2. 步骤二：手动将 tesseract 加入系统 PATH 环境变量
按 Win + S，搜索并打开 "环境变量"
搜索：环境变量 或 Edit environment variables
点击："编辑系统环境变量" → 再点击右下角的 "环境变量"
在"系统变量"区域，找到并双击 Path，如下图所示：
点击"新建"，然后粘贴你的安装路径：

如：C:\Program Files\Tesseract-OCR
点"确定"保存并关闭所有窗口。

🔄 重新启动你的终端（CMD / PowerShell / VSCode / PyCharm 等）

3. 如果你按照上面启动虚拟环境，请更改doc_parser文件中的路径
   
  将 pytesseract.pytesseract.tesseract_cmd = r"D:\Tesseract-OCR\tesseract.exe"
  替换为你实际安装的地址（比如C:\Program Files\Tesseract-OCR\tesseract.exe"）

4. 确保Tesseract-OCR下的tessdata含有中文与英文训练数据

~~~txt
C:\Program Files\Tesseract-OCR\
├── tesseract.exe         ← 主程序
├── tessdata\             ← 【语言训练数据包文件夹】
│   ├── eng.traineddata   ← 英语识别模型（默认自带）
│   ├── chi_sim.traineddata ← 简体中文识别模型（可能没有，需要下载）
│   └── ...（其它语言）
└── ...
~~~
简体中文训练数据没有的话可以去官网下载：https://github.com/tesseract-ocr/tessdata
下载后放到 tessdata 目录下即可

然后上传图片/图片类型PDF就可以正常分块解析了。

## 识别视频音频转写（Whisper）指南

视频转写依赖于ffmpeg工具用于音频提取。

1. 下载ffmpeg：
   - 访问官网下载页面：https://ffmpeg.org/download.html
   - Windows用户推荐下载静态编译版（如：ffmpeg-release-essentials.zip），解压到任意目录。
2. 配置环境变量：
   - 将解压目录下的bin文件夹路径（如C:\ffmpeg\bin）加入系统PATH环境变量。
   - Win+S搜索"环境变量"，编辑系统变量Path，添加bin路径。
   - 重新启动终端。
3. 验证安装：
   - 打开命令行，输入 `ffmpeg -version`，出现版本信息即为安装成功。

如未安装ffmpeg，视频转写功能将无法使用。
