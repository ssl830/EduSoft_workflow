# 教学内容自动生成功能说明文档

## 一、功能概述

本功能基于AI技术，通过分析教师提供的课程大纲和已有的课程知识库文档，自动生成完整的教学内容设计方案。生成的内容包括：
- 知识点讲解
- 实训练习设计
- 教学指导建议
- 课时分配方案
- 知识点关联资料

## 二、系统架构

### 1. 整体架构
- 前端：Vue3 + Quasar UI框架
- 后端：Spring Boot
- AI微服务：Python FastAPI
- 向量数据库：FAISS
- 大语言模型：DeepSeek API

### 2. 核心模块
1. 文档处理模块（`doc_parser.py`）
   - 支持格式：PDF、Word、TXT、Markdown、JSON、CSV、Excel、HTML
   - 智能分块：基于语义的文档切分
   - 错误处理：完整的异常处理机制

2. 向量化模块（`embedding.py`）
   - 使用DeepSeek API生成文本向量
   - 支持批量处理
   - 向量缓存机制

3. 知识库模块（`faiss_db.py`）
   - 基于FAISS的向量检索
   - 支持增量更新
   - 高效的相似度搜索

4. RAG服务模块（`rag.py`）
   - 知识点提取
   - 内容生成
   - 练习题生成
   - 答案评估

5. 提示词管理（`prompts.py`）
   - 模板化提示词
   - 多场景支持
   - 易于维护和优化

## 三、使用流程

### 1. 知识库建设
1. 教师上传课程相关文档（课件、教材、练习等）
2. 系统自动处理文档：
   - 提取文本内容
   - 生成文本向量
   - 存入知识库

### 2. 生成教学内容
1. 教师输入：
   - 课程名称
   - 课程大纲
   - 预期课时数

2. 系统处理：
   - 提取关键知识点
   - 检索相关资料
   - 生成教学内容
   - 设计练习题
   - 制定时间分配方案

3. 结果导出：
   - Word格式（适合打印和编辑）
   - Markdown格式（适合在线展示）
   - JSON格式（适合系统集成）

## 四、API接口说明

### 1. 后端接口（Spring Boot）

```java
// 教学内容生成
POST /api/teaching/content/generate
Request: {
    courseName: string,
    courseOutline: string,
    expectedHours: number
}
Response: {
    lessons: Array<{
        title: string,
        content: string,
        practiceContent: string,
        teachingGuidance: string,
        suggestedHours: number,
        knowledgeSources: string[]
    }>,
    totalHours: number,
    timeDistribution: string,
    teachingAdvice: string
}

// 保存教学内容
POST /api/teaching/content/save
Request: {
    courseName: string,
    content: TeachingContentResponse
}
```

### 2. AI微服务接口（FastAPI）

```python
# 文档上传并向量化
POST /embedding/upload
- 支持multipart/form-data
- 返回处理结果

# 生成教学内容
POST /rag/generate
Request: {
    "course_name": str,
    "course_outline": str,
    "expected_hours": int
}
Response: TeachingContentResponse

# 生成练习题
POST /rag/generate_exercise
Request: {
    "course_name": str,
    "lesson_content": str,
    "difficulty": str
}
```

## 五、部署说明

### 1. 环境要求
- Java 17+
- Python 3.8+
- Node.js 16+
- DeepSeek API密钥

### 2. 配置文件
1. AI微服务（`.env`）：
```
DEEPSEEK_API_KEY=your_api_key
VECTOR_DB_PATH=data/vector_db
```

2. Spring Boot（`application.yml`）：
```yaml
ai:
  service:
    url: http://localhost:8000
    timeout: 30000
```

### 3. 启动步骤
1. 启动AI微服务：
```bash
cd ai_service
pip install -r requirements.txt
uvicorn main:app --reload
```

2. 启动后端：
```bash
./mvnw spring-boot:run
```

3. 启动前端：
```bash
cd frontend/project
npm install
npm run dev
```

## 六、错误处理

### 1. 日志系统
- 位置：`ai_service/utils/logger.py`
- 分类：API调用、文档处理、向量操作、内容生成
- 轮转策略：按日期轮转，保留最近5个日志文件

### 2. 常见错误处理
1. 文档处理错误：
   - 不支持的文件格式
   - 文件损坏或无法读取
   - 内容提取失败

2. API错误：
   - DeepSeek API调用失败
   - 请求超时
   - 额度限制

3. 生成错误：
   - 内容生成失败
   - 格式解析错误
   - 知识库检索失败

## 七、性能优化

### 1. 向量检索优化
- 使用FAISS的IVF索引
- 批量处理向量
- 缓存常用查询

### 2. 文档处理优化
- 并行处理大文件
- 智能分块策略
- 文本清洗和规范化

### 3. 前端优化
- 分页加载
- 组件懒加载
- 本地缓存

## 八、后续优化建议

1. 功能扩展：
   - 支持更多文档格式
   - 添加更多AI模型选择
   - 实现协同编辑

2. 性能提升：
   - 添加分布式处理
   - 优化向量索引
   - 实现增量更新

3. 用户体验：
   - 添加进度反馈
   - 优化错误提示
   - 支持自定义模板

4. 安全性：
   - 添加访问控制
   - 实现数据加密
   - 完善审计日志 